#!/usr/bin/env perl

use warnings;
use strict;
use FindBin;
use YAML qw(LoadFile);
use lib ("$FindBin::Bin/../lib");

use Plerd;

my $config_ref = LoadFile( "$FindBin::Bin/../conf/plerd.conf" );
my $plerd = Plerd->new( $config_ref );

for my $post ( @{ $plerd->posts } ) {
    for my $wm ( values %{$post->webmentions_by_source} ) {
        $wm->verify;
        sleep 1;
    }
    $post->serialize_webmentions;
}
